# Jay Stack: Page Configuration (`page.conf.yaml`)

## Overview

The `page.conf.yaml` file allows you to define a page's dependencies and configuration in a headless manner, without requiring a `page.jay-html` template file. This is particularly useful for:

1.  **Headless CMS / Design Tool Integration:** When pages are generated by external tools (like Figma) that define the data structure (`jay-contract`) and dependencies but haven't generated the view template yet.
2.  **Drafting:** Creating the structure of a page and its data requirements before implementing the UI.

## File Location

The file must be named `page.conf.yaml` and placed directly inside the page's directory, alongside `page.jay-contract` (if it exists).

**Example Structure:**
```
src/pages/
  ├── home/
  │   ├── page.jay-contract
  │   └── page.conf.yaml     <-- Configuration file
  └── products/
      └── [id]/
          ├── page.jay-contract
          └── page.conf.yaml
```

## Configuration Schema

The file is a standard YAML file with the following structure:

```yaml
# List of headless components used on this page
used_components:
  - name: <component-name>
    src: <app-module-name>
    key: <data-binding-key>
```

### Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `used_components` | Array | No | A list of components from installed apps that this page consumes. |

### Component Definition

Each item in `used_components` requires:

*   **`name`**: The name of the component as defined in the installed app's configuration.
*   **`src`**: The module name or app name of the installed application providing the component (e.g., `wix-jay-headless-store`).
*   **`key`**: The unique key used to identify this component's data in the page's data context.

## Precedence Rules

The Jay Stack Dev Server uses the following logic to determine a page's used components:

1.  **`page.jay-html` (Highest Priority):** If a `page.jay-html` file exists in the directory, the server parses it for `<script type="application/jay-headless">` tags. The `page.conf.yaml` file is **ignored** for component definitions in this case.
2.  **`page.conf.yaml`:** If `page.jay-html` is **missing**, the server reads `used_components` from `page.conf.yaml`.
3.  **Fallback:** If neither exists, the page is assumed to use no external components.

## Example

**File:** `src/pages/products/[id]/page.conf.yaml`

```yaml
used_components:
  # Use the product details component from the store app
  - name: productPage
    src: wix-jay-headless-store
    key: product

  # Use the reviews component from a reviews app
  - name: reviewList
    src: jay-reviews-app
    key: reviews
```

This configuration declares that the page requires data from `productPage` (bound to `product`) and `reviewList` (bound to `reviews`). When the `getContracts` API is called, it will return the full contracts for these components as part of the page's requirements.

