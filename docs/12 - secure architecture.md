Secure Architecture
===

as noted in [02 - Jay Element and Component](02%20-%20Jay%20Element%20vs%20Component.md)
and in [09 - save events](09%20-%20Safe%20events.md), the main architecture idea 
for securing Jay Components is to run the Component in a worker, while the Element runs in the main window.

This document explores this architecture.

Basic Architecture
---

The basic architecture of a jay application is a tree of elements and components as in the following diagram

![Jay Basic architecture 1](12%20-%20Secure%20Architecture%201.png)

We note that a component has only one child element, while an element may have one or more 
child components. The child components of an element can be static, under condition, or under for each.

The secure architecture is 

![Jay Basic architecture 2](12%20-%20Secure%20Architecture%202.png)

We note in this diagram a few additional things

1. we have two root components - the `main root` and the `worker root`, which
   are responsible for the creation of the Jay component and element structure 
   and establishing a `communication channel`.
2. on the worker, we replace each element with an `element bridge` or `element stab`. 
3. The `element bridge` is generated by the compiler and acts like the element, 
   except it does not render DOM. instead, it records the input `ViewState` and 
   creates instances of child components when needed
4. The `element stab` only role is to record the input `ViewState` and need not 
   be compiler generated
5. The `Null Component` is in the position of the root component in the main thread
   and passes the recorded `ViewState` of the root component to the first element
6. The `Component Bridge` receives the `ViewState` from the worker and passes it
   into the Element.


