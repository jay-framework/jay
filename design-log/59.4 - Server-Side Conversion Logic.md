# 59.4 - Server-Side Vendor Adapters (Figma Converter)

## Context

In the [Vendor Adapter Architecture](./59%20-%20Server-Side%20Figma%20Conversion%20and%20Bi-directional%20Sync.md), the **Vendor Adapter** resides on the server and performs the conversion from Vendor JSON to `jay-html`.

This log details the implementation of the **Figma Adapter**.

## Goals

1.  **Implement Interface:** Conform to the `VendorAdapter` interface defined in Log 59.2.
2.  **Conversion Logic:** Port existing logic to work on `FigmaInterchangeDoc` (JSON) instead of the Figma API.

## Architecture

### The Adapter Class

```typescript
import { VendorAdapter } from '../core/types';
import { FigmaInterchangeDoc } from '@jay-framework/figma-interchange';

export class FigmaAdapter implements VendorAdapter {
  readonly vendorId = 'figma';

  async convert(data: FigmaInterchangeDoc): Promise<string> {
    // 1. Validate version
    // 2. Instantiate Converter Engine
    const converter = new FigmaToJayConverter();
    return converter.process(data.root);
  }
}
```

### Conversion Logic

- **Input:** `InterchangeNode` (Recursive JSON structure).
- **Output:** Jay HTML String (`.jay-html`).
- **Process:**
  - Map `InterchangeNode.type` ('FRAME', 'TEXT') to standard HTML tags or Jay components.
  - Map `InterchangeNode.jayData` to Jay directives (`j-text`, `j-if`) and bindings.
  - Map `InterchangeNode` layout props (AutoLayout) to CSS/Style attributes suitable for Jay.

### Asset Processing

- The Adapter expects images to be already uploaded or referenced.
- The JSON should contain asset references (e.g., `imageRef: "assets/hash.png"`).
- The Converter simply generates the `<img>` tag using this reference path: `<img src="/assets/hash.png">`.

## Integration

- This adapter will be registered in the `jay-dev-server` startup sequence.
